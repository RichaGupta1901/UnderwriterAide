<!-- backend/templates/policy_template.html -->
<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>{{ product.product_name or "Insurance Policy" }} - Policy Schedule</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; line-height: 1.6; }
    .header { text-align: center; border-bottom: 2px solid #2c3e50; padding-bottom: 20px; }
    .section { margin: 20px 0; }
    .section h3 { color: #2c3e50; border-bottom: 1px solid #ecf0f1; padding-bottom: 5px; }
    .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 15px 0; }
    .info-item { background: #f8f9fa; padding: 10px; border-radius: 5px; }
    .benefits-list { background: #f1f2f6; padding: 15px; border-radius: 8px; }
    .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #bdc3c7; font-size: 12px; color: #7f8c8d; }
  </style>
</head>
<body>
  <div class="header">
    <h1>{{ fund.Name if fund else 'Private Health Fund' }}</h1>
    <h2>Policy Schedule â€” {{ product.product_name or "Insurance Policy" }}</h2>
    <p><strong>Extract Date:</strong> {{ product.extract_date or "Not specified" }}</p>
  </div>

  {% if user_data and user_data.personal_info %}
  <div class="section">
    <h3>Policyholder Information</h3>
    <div class="info-grid">
      <div class="info-item">
        <strong>Full Name:</strong> {{ user_data.personal_info.full_name }}
      </div>
      <div class="info-item">
        <strong>Date of Birth:</strong> {{ user_data.personal_info.dob }}
      </div>
      <div class="info-item">
        <strong>Gender:</strong> {{ user_data.personal_info.gender }}
      </div>
      <div class="info-item">
        <strong>Contact:</strong> {{ user_data.personal_info.email }}
      </div>
    </div>
  </div>
  {% endif %}

  <div class="section">
    <h3>Policy Details</h3>
    <div class="info-grid">
      <div class="info-item">
        <strong>Product ID:</strong> {{ product.product_id }}
      </div>
      <div class="info-item">
        <strong>Status:</strong> {{ product.open_closed }}
      </div>
      <div class="info-item">
        <strong>Type:</strong> {{ product.product_type }}
      </div>
      <div class="info-item">
        <strong>Sum Insured:</strong> ${{ "{:,.2f}".format(product.sum_insured) if product.sum_insured else "Not specified" }}
      </div>
    </div>
  </div>

  {% if product.benefits %}
  <div class="section">
    <h3>Benefits Coverage</h3>
    <div class="benefits-list">
      {% for benefit in product.benefits %}
      <div style="margin: 10px 0; padding: 8px; background: white; border-radius: 4px;">
        <strong>{{ benefit.code }}:</strong> {{ benefit.text }}<br>
        <em>Coverage Limit: ${{ "{:,.2f}".format(benefit.amount) if benefit.amount else "Unlimited" }}</em>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}

  {% if user_data and user_data.health_lifestyle %}
  <div class="section">
    <h3>Health Information</h3>
    <div class="info-grid">
      <div class="info-item">
        <strong>Smoker:</strong> {{ "Yes" if user_data.health_lifestyle.smoker else "No" }}
      </div>
      <div class="info-item">
        <strong>Pre-existing Conditions:</strong> {{ ", ".join(user_data.health_lifestyle.pre_existing_conditions) if user_data.health_lifestyle.pre_existing_conditions else "None declared" }}
      </div>
    </div>
  </div>
  {% endif %}

  <div class="footer">
    <p><em>This document is auto-generated from insurance data. This summary is generated automatically and requires legal review.</em></p>
    <p>Generated on: {{ timestamp }}</p>
  </div>
</body>
</html>